setwd("C:\\Users\\Manjari.Murala\\Desktop\\Finalexam\\Finalexam")
setwd("C:\\Users\\Manjari.Murala\\Desktop\\Finalexam\\Finalexam")
bse <- read.csv("BSE_Sensex_Index.csv")
S_Close <- c()
for (i in 1:15446){
S_Close[i] <- (bse$Close[i] - bse$Close[i+1]) / bse$Close[i+1]
}
S_Close[15447] <- (S_Close[15446] + S_Close[15445] + S_Close[15444]) / 3
S_Close[15447]
Z_S_Close <- c()
mean_S_Close <- mean(SGR_Close)
mean_S_Close
sd_S_Close <- sd(SGR_Close)
sd_S_Close
for (j in 1:15447) {
Z_S_Close[j] <- (S_Close[j] - mean_S_Close) / (sd_S_Close)
}
o_d <- c()
o_c <- 0
otd <- 1
for (k in 1:15447) {
if (Z_S_Close[k] > 3) {
o_c <- o_c + 1
o_d[otd] <- bse$Date[k]
otd <- otd + 1
}
if (Z_S_Close[k] < -3) {
o_c <- o_c + 1
o_d[otd] <- bse$Date[k]
otd <- otd + 1
}
}
o_c
o_d
setwd("C:\\Users\\Manjari.Murala\\Desktop\\Finalexam\\Finalexam")
bse <- read.csv("BSE_Sensex_Index.csv")
S_Close <- c()
for (i in 1:15446){
S_Close[i] <- (bse$Close[i] - bse$Close[i+1]) / bse$Close[i+1]
}
S_Close[15447] <- (S_Close[15446] + S_Close[15445] + S_Close[15444]) / 3
S_Close[15447]
Z_S_Close <- c()
mean_S_Close <- mean(SGR_Close)
mean_S_Close
sd_S_Close <- sd(SGR_Close)
sd_S_Close
for (j in 1:15447) {
Z_S_Close[j] <- (S_Close[j] - mean_S_Close) / (sd_S_Close)
}
o_d <- c()
o_c <- 0
otd <- 1
for (k in 1:15447) {
if (Z_S_Close[k] > 3) {
o_c <- o_c + 1
o_d[otd] <- bse$Date[k]
otd <- otd + 1
}
if (Z_S_Close[k] < -3) {
o_c <- o_c + 1
o_d[otd] <- bse$Date[k]
otd <- otd + 1
}
}
o_c
o_d
data = read.csv("Liver_data.csv", header = FALSE, col.names = c("1", "2", "3", "4", "5", "6", "7"))
str(data)
summary(data)
x = data[,1:5]
y = data[,6]
fit = kmeans(x,4)
library(class)
knnfit = knn(fit$centers,x,as.factor(c(-2,-1,1,2)))
error = 1-sum(knnfit == y)/length(y)
error
data = read.csv("Liver_data.csv", header = FALSE, col.names = c("1", "2", "3", "4", "5", "6", "7"))
str(data)
summary(data)
x = data[,1:5]
y = data[,6]
fit = kmeans(x,4)
library(class)
knnfit = knn(fit$centers,x,as.factor(c(-2,-1,1,2)))
error = 1-sum(knnfit == y)/length(y)
error
error
data = read.csv("Liver_data.csv", header = FALSE, col.names = c("1", "2", "3", "4", "5", "6", "7"))
str(data)
summary(data)
x = data[,1:5]
y = data[,6]
fit = kmeans(x,4)
library(class)
knnfit = knn(fit$centers,x,as.factor(c(-2,-1,1,2)))
error = 1-sum(knnfit == y)/length(y)
error
library(readxl)
X8th_question <- read_excel("C:\\Users\\Manjari Murala\\Desktop\\DataScience\\Final exam\\Solutions\\8th question")
View(X8th_question)
data = read.csv("Liver_data.csv", header = FALSE, col.names = c("1", "2", "3", "4", "5", "6", "7"))
str(data)
summary(data)
x = data[,1:5]
y = data[,6]
fit = kmeans(x,4)
library(class)
knnfit = knn(fit$centers,x,as.factor(c(-2,-1,1,2)))
error = 1-sum(knnfit == y)/length(y)
error
liver = read.csv("Liver_data.csv", header = FALSE, col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector"))
str(liver_data)
liver$selector <- as.factor(liver$selector)
liver$drinks <- cut(liver$drinks, breaks = c(0, 5,10,15,20),
labels = c('C1', 'C2', "C3", 'C4'), right = FALSE)
liver <- na.omit(liver)
train = subset(liver, liver$selector == 1)
str(train)
test = subset(liver, liver$selector == 2)
str(test)
dim(train)
dim(test)
x_train <- subset(train, select = -c(selector, drinks))
x_test <- subset(test, select = -c(selector, drinks))
library(class)
y_train = train[,6, drop = TRUE]
y_test = test[,6, drop = TRUE]
length(train)
length(test)
library(e1071)
#SVM
#For training
fit = svm(x_train, y_train)
1-sum(y_train==predict(fit,x_train))/length(y_train)
#Misclassification error: 0.2027
#For test data
fit = svm(x_test, y_test)
1-sum(y_test==predict(fit,x_test))/length(y_test)
#Misclassification error: 0.265
#The error for svm is less than knn
liver = read.csv("Liver_data.csv", header = FALSE, col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector"))
str(liver_data)
liver$selector <- as.factor(liver$selector)
liver$drinks <- cut(liver$drinks, breaks = c(0, 5,10,15,20),
labels = c('C1', 'C2', "C3", 'C4'), right = FALSE)
liver <- na.omit(liver)
train = subset(liver, liver$selector == 1)
str(train)
test = subset(liver, liver$selector == 2)
str(test)
dim(train)
dim(test)
x_train <- subset(train, select = -c(selector, drinks))
x_test <- subset(test, select = -c(selector, drinks))
library(class)
y_train = train[,6, drop = TRUE]
y_test = test[,6, drop = TRUE]
length(train)
length(test)
library(e1071)
#SVM
#For training
fit = svm(x_train, y_train)
1-sum(y_train==predict(fit,x_train))/length(y_train)
#Misclassification error: 0.2027
#For test data
fit = svm(x_test, y_test)
1-sum(y_test==predict(fit,x_test))/length(y_test)
#Misclassification error: 0.265
#The error for svm is less than knn
ldata = read.csv("lenses.data.csv", header = FALSE, col.names = c("index", "age", "spectacle_prescription", "astigmatic", "tear_production_rate", "Class"))
ldata$index <- NULL
library(rpart)
y<-as.factor(ldata[,5])
x<-ldata[,1:4]
model1<-rpart(y~.,x, parms = list(split = 'information'),
control=rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=5))
library(rpart.plot)
rpart.plot(model1)
gain <- sum(y==predict(model1,x,type="class"))/length(y)
gain
error_rate <- 1-sum(y==predict(model1,x,type="class"))/length(y)
error_rate
